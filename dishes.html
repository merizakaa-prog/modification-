<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>قائمة الأطباق</title>
<style>
body {font-family:tahoma;background:#f3f3f3;margin:0;padding:15px}

/* شبكة الأطباق */
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:15px;
}
.item{
  background:#fff;
  border-radius:12px;
  padding:12px;
  text-align:center;
  box-shadow:0 2px 6px rgba(0,0,0,.15)
}
.item img{
  width:90px;
  height:90px;
  border-radius:50%;
  border:3px solid #8b0000;
  cursor:pointer
}
h3{margin:8px 0 4px;font-size:16px}
p{margin:0;font-size:14px;color:#444}

/* نافذة التفاصيل */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  justify-content:center;
  align-items:center;
  z-index:999
}
.modal-content{
  background:#fff;
  width:90%;
  max-width:500px;
  border-radius:10px;
  padding:15px;
  position:relative
}
.modal video{
  width:100%;
  border-radius:10px
}
.close{
  position:absolute;
  top:10px;
  left:10px;
  font-size:22px;
  cursor:pointer;
  color:#8b0000
}
.info{
  margin-top:10px;
  font-size:14px
}
.confirm-btn{
  margin-top:10px;
  width:100%;
  padding:10px;
  font-size:16px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  background:#8b0000;
  color:white;
  transition:0.3s;
}
.confirm-btn.confirmed{
  background:green;
}
</style>
</head>
<body>

<div class="grid" id="dishesGrid"></div>

<!-- نافذة الفيديو + التفاصيل -->
<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">✖</span>
    <video id="videoPlayer" controls></video>
    <div class="info">
      <p><strong>الطبق:</strong> <span id="dishName"></span></p>
      <p><strong>المكونات:</strong> <span id="ingredients"></span></p>
      <p><strong>الفوائد:</strong> <span id="nutrition"></span></p>
    </div>
    <button id="confirmBtn" class="confirm-btn" onclick="confirmOrder(this)">تأكيد الطلب</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* بيانات Firebase */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "restaurant-e323a.firebaseapp.com",
  projectId: "restaurant-e323a",
  storageBucket: "restaurant-e323a.appspot.com",
  messagingSenderId: "309092455734",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadDishes(){
  const querySnapshot = await getDocs(collection(db,"dishes"));
  const grid = document.getElementById("dishesGrid");
  grid.innerHTML = "";

  querySnapshot.forEach(docSnap=>{
    const d = docSnap.data();
    grid.innerHTML += `
      <div class="item">
        <img src="${d.image}" onclick="openModal('${d.video}','${d.name}','${d.ingredients}','${d.nutrition}')">
        <h3>${d.name}</h3>
        <p>${d.price} دج</p>
      </div>
    `;
  });
}

/* فتح نافذة التفاصيل */
window.openModal = function(video,name,ingredients,nutrition){
  document.getElementById("dishName").textContent = name;
  document.getElementById("ingredients").textContent = ingredients;
  document.getElementById("nutrition").textContent = nutrition;

  const videoPlayer = document.getElementById("videoPlayer");
  videoPlayer.src = video;
  videoPlayer.play();

  const confirmBtn = document.getElementById("confirmBtn");
  confirmBtn.classList.remove("confirmed");
  confirmBtn.disabled = false;
  confirmBtn.textContent = "تأكيد الطلب";

  document.getElementById("modal").style.display = "flex";
}

/* إغلاق نافذة التفاصيل */
window.closeModal = function(){
  const video = document.getElementById("videoPlayer");
  video.pause();
  video.src = "";
  document.getElementById("modal").style.display = "none";
}

/* تأكيد الطلب */
window.confirmOrder = function(btn){
  btn.classList.add("confirmed");
  btn.textContent = "تم التأكيد ✔";
  btn.disabled = true;

  // هنا يمكنك إضافة كود إرسال الطلب إلى صفحة الطلبات أو Firebase
}

await loadDishes();
</script>

</body>
</html>
