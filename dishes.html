<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ù‚</title>
<style>
body{font-family:tahoma;background:#f3f3f3;margin:0;padding:15px}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:15px
}

.item{
  background:#fff;
  border-radius:12px;
  padding:12px;
  text-align:center;
  box-shadow:0 2px 6px rgba(0,0,0,.15)
}

.item img{
  width:90px;
  height:90px;
  border-radius:50%;
  border:3px solid #8b0000;
  cursor:pointer
}

h3{margin:8px 0 4px;font-size:16px}
p{margin:0;font-size:14px;color:#444}

.confirm-btn{
  margin-top:8px;
  padding:8px;
  width:100%;
  border:none;
  border-radius:6px;
  background:#8b0000;
  color:white;
  cursor:pointer;
  font-size:14px;
  transition:0.3s;
}
.confirm-btn.confirmed{
  background:#28a745;
}

/* ===== Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ ===== */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  justify-content:center;
  align-items:center;
  z-index:999
}

.modal-content{
  background:#fff;
  width:90%;
  max-width:500px;
  border-radius:10px;
  padding:15px;
  position:relative;
  text-align:right;
}

.modal video{
  width:100%;
  border-radius:10px
}

.close{
  position:absolute;
  top:10px;
  left:10px;
  font-size:22px;
  cursor:pointer;
  color:#8b0000
}

.info{
  margin-top:10px;
  font-size:14px
}
</style>
</head>
<body>

<div class="grid" id="dishesGrid"></div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ + Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">âœ–</span>
    <video id="videoPlayer" controls></video>
    <div class="info">
      <p><strong>Ø§Ù„Ø·Ø¨Ù‚:</strong> <span id="dishName"></span></p>
      <p><strong>Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:</strong> <span id="ingredients"></span></p>
      <p><strong>Ø§Ù„ÙÙˆØ§Ø¦Ø¯:</strong> <span id="nutrition"></span></p>
      <button id="confirmBtn" class="confirm-btn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ğŸ”´ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹ Firebase */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "restaurant-e323a.firebaseapp.com",
  projectId: "restaurant-e323a",
  storageBucket: "restaurant-e323a.appspot.com",
  messagingSenderId: "309092455734",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadDishes(){
  const querySnapshot = await getDocs(collection(db,"dishes"));
  const grid = document.getElementById("dishesGrid");
  grid.innerHTML = "";

  querySnapshot.forEach(docSnap=>{
    const d = docSnap.data();
    grid.innerHTML += `
      <div class="item">
        <img src="${d.image}" onclick="openModal('${d.video}','${d.name}','${d.ingredients}','${d.nutrition}','${d.price}')">
        <h3>${d.name}</h3>
        <p>${d.price} Ø¯Ø¬</p>
      </div>
    `;
  });
}

window.openModal = function(video,name,ingredients,nutrition,price){
  document.getElementById("dishName").textContent = name;
  document.getElementById("ingredients").textContent = ingredients;
  document.getElementById("nutrition").textContent = nutrition;

  const videoPlayer = document.getElementById("videoPlayer");
  videoPlayer.src = video;
  videoPlayer.play();

  const confirmBtn = document.getElementById("confirmBtn");
  confirmBtn.textContent = "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨";
  confirmBtn.classList.remove("confirmed");
  confirmBtn.disabled = false;

  confirmBtn.onclick = function(){
    let orders = JSON.parse(localStorage.getItem("orders")) || [];
    orders.push({name:name, price:price});
    localStorage.setItem("orders", JSON.stringify(orders));

    confirmBtn.textContent = "ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯ âœ”";
    confirmBtn.classList.add("confirmed");
    confirmBtn.disabled = true;
  }

  document.getElementById("modal").style.display = "flex";
}

window.closeModal = function(){
  const video = document.getElementById("videoPlayer");
  video.pause();
  video.src = "";
  document.getElementById("modal").style.display = "none";
}

await loadDishes();
</script>

</body>
</html>
