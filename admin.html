<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ù‚</title>

<style>
body{
  font-family:tahoma;
  background:#f3f3f3;
  padding:20px
}
h2{text-align:center}
.card{
  background:#fff;
  padding:15px;
  margin-bottom:15px;
  border-radius:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.15)
}
input,textarea{
  width:100%;
  padding:8px;
  margin:6px 0;
  font-family:tahoma
}
img{
  width:80px;
  height:80px;
  border-radius:50%;
  border:2px solid #8b0000;
  cursor:pointer;
  display:block;
  margin-bottom:8px
}
button{
  width:100%;
  padding:10px;
  background:#8b0000;
  color:#fff;
  border:none;
  border-radius:6px;
  font-size:15px;
  cursor:pointer
}
</style>
</head>
<body>

<h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
<div id="panel"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs,
  doc,
  updateDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ğŸ”´ Ø¶Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "restaurant-e323a.firebaseapp.com",
  projectId: "restaurant-e323a",
  storageBucket: "restaurant-e323a.appspot.com",
  messagingSenderId: "309092455734",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const images = ["makla1.png","makla2.png","makla3.png"];
const panel = document.getElementById("panel");

/* Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø·Ø¨Ø§Ù‚ */
const querySnapshot = await getDocs(collection(db,"dishes"));

querySnapshot.forEach(docSnap=>{
  const d = docSnap.data();
  const id = docSnap.id;

  const card = document.createElement("div");
  card.className = "card";

  /* Ø§Ù„ØµÙˆØ±Ø© */
  const img = document.createElement("img");
  img.src = d.image;
  img.onclick = ()=>{
    let i = (images.indexOf(img.src.split("/").pop())+1)%images.length;
    img.src = images[i];
  };

  /* Ø§Ù„Ø§Ø³Ù… */
  const name = document.createElement("input");
  name.value = d.name;
  name.placeholder = "Ø§Ø³Ù… Ø§Ù„Ø·Ø¨Ù‚";

  /* Ø§Ù„Ø³Ø¹Ø± */
  const price = document.createElement("input");
  price.type = "number";
  price.value = d.price;
  price.placeholder = "Ø§Ù„Ø³Ø¹Ø±";

  /* Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
  const video = document.createElement("input");
  video.value = d.video;
  video.placeholder = "Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø£Ùˆ vi.mp4";

  /* Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª */
  const ing = document.createElement("textarea");
  ing.value = d.ingredients;
  ing.placeholder = "Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª";

  /* Ø§Ù„ÙÙˆØ§Ø¦Ø¯ */
  const nut = document.createElement("textarea");
  nut.value = d.nutrition;
  nut.placeholder = "Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©";

  /* Ø²Ø± Ø§Ù„Ø­ÙØ¸ */
  const btn = document.createElement("button");
  btn.textContent = "Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª";
  btn.onclick = async ()=>{
    await updateDoc(doc(db,"dishes",id),{
      name: name.value,
      price: Number(price.value),
      image: img.src.split("/").pop(),
      video: video.value,
      ingredients: ing.value,
      nutrition: nut.value
    });
    alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ”");
  };

  card.append(img,name,price,video,ing,nut,btn);
  panel.appendChild(card);
});
</script>

</body>
</html>
